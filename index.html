<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Even Hub Starter Kit</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: Canvas;
      --fg: CanvasText;
      --border: color-mix(in srgb, CanvasText 12%, Canvas 88%);
      --muted: color-mix(in srgb, CanvasText 60%, Canvas 40%);
      --ok: #0a7;
      --bad: #c21;
      --accent: #376dff;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Inter, system-ui, sans-serif; background: var(--bg); color: var(--fg); }
    .app { max-width: 760px; margin: 0 auto; padding: 18px 14px 30px; display: grid; gap: 18px; }
    .card { display: grid; gap: 10px; }
    h1,h2,h3,p { margin: 0; }
    h1 { font-size: 1.35rem; }
    h2 { font-size: 1.02rem; }
    .muted { color: var(--muted); }
    .tiny { font-size: .82rem; }
    .section-rule { border-top: 1px solid var(--border); padding-top: 12px; }
    .pill-row { display: flex; flex-wrap: wrap; gap: 8px; }
    .pill { border: 1px solid var(--border); border-radius: 999px; padding: 4px 9px; font-size: .74rem; }
    .status-chip {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 3px 10px;
      font-size: .75rem;
      width: fit-content;
    }
    .status-chip.running { color: #8a6100; }
    .status-chip.success { color: var(--ok); }
    .status-chip.failed { color: var(--bad); }
    button {
      border: 1px solid var(--border);
      border-radius: 999px;
      min-height: 38px;
      padding: 8px 13px;
      font: inherit;
      background: transparent;
      color: inherit;
      cursor: pointer;
    }
    button.primary {
      border-color: color-mix(in srgb, var(--border) 74%, var(--accent) 26%);
      background: color-mix(in srgb, var(--accent) 8%, Canvas 92%);
      font-weight: 600;
    }
    button:disabled { opacity: .5; cursor: not-allowed; }
    .row { display: flex; flex-wrap: wrap; gap: 8px; }
    .next-test-grid { display: grid; gap: 8px; }
    .checklist {
      margin: 0;
      padding-left: 18px;
      display: grid;
      gap: 5px;
      font-size: .9rem;
    }
    .question-card {
      border-left: 2px solid var(--border);
      padding-left: 10px;
      display: grid;
      gap: 10px;
    }
    details summary { cursor: pointer; font-weight: 600; }
    details summary::-webkit-details-marker { display: none; }
    details summary::after { content: "▾"; float: right; color: var(--muted); }
    details:not([open]) summary::after { content: "▸"; }
    textarea, input[type="search"] {
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 9px;
      font: inherit;
      background: transparent;
      color: inherit;
    }
    pre {
      margin: 0;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 9px;
      white-space: pre-wrap;
      max-height: 240px;
      overflow: auto;
      font-size: .79rem;
    }
    .collapse-panel:not([open]) > :not(summary) { display: none; }
    .collapse-panel[open] { padding-top: 8px; border-top: 1px solid var(--border); }
    .ok { color: var(--ok); font-weight: 700; }
    .bad { color: var(--bad); font-weight: 700; }
    .status-grid { display: grid; gap: 7px; font-size: .84rem; }
  </style>
</head>
<body>
  <main class="app">
    <section class="card">
      <h1>Even Hub Starter Kit</h1>
      <p class="muted">Guided test runner for real glasses checks. This flow is designed so each run can be exported into the repo.</p>
      <div class="pill-row">
        <span class="pill">Static site · no build step</span>
        <span class="pill">Guided “Next Test” flow</span>
        <span class="pill">Repo-based run files</span>
      </div>
    </section>

    <section class="card section-rule">
      <h2>Next Test</h2>
      <div class="next-test-grid">
        <p><strong id="nextTestTitle">Loading next test…</strong></p>
        <p><strong>Goal:</strong> <span id="nextTestGoal"></span></p>
        <div>
          <p><strong>What to look for on glasses:</strong></p>
          <ul id="nextTestLookFor" class="checklist"></ul>
        </div>
        <div class="row">
          <button id="btnRunNextTest" class="primary">Run Next Test</button>
          <span id="runState" class="status-chip">not started</span>
        </div>
      </div>
    </section>

    <section class="card section-rule" id="confirmationSection" hidden>
      <h2>Human confirmation</h2>
      <div class="question-card">
        <p><strong>Did you see the expected result on the glasses?</strong></p>
        <div class="row">
          <button data-result="yes" class="result-btn">Yes</button>
          <button data-result="no" class="result-btn">No</button>
          <button data-result="not-sure" class="result-btn">Not sure</button>
        </div>
        <details>
          <summary>Add optional notes</summary>
          <textarea id="notesInput" placeholder="Optional details that will go into the run file."></textarea>
        </details>
        <div class="row">
          <button id="btnExportRun" disabled>Export run file</button>
        </div>
        <p class="tiny muted">Commit this exported run file into <code>/testing/runs/</code>.</p>
        <p id="lastSavedMessage" class="tiny muted"></p>
      </div>
    </section>

    <section class="card section-rule">
      <p class="tiny muted">Live status snapshot</p>
      <div class="status-grid">
        <div>SDK: <span id="sdkStatus" class="bad">not loaded</span></div>
        <div>flutter_inappwebview: <span id="fiawvStatus" class="bad">unknown</span></div>
        <div>Bridge ready: <span id="bridgeStatus" class="bad">unknown</span></div>
        <div>Startup page: <span id="startupStatus" class="bad">not created</span></div>
      </div>
    </section>

    <section class="card section-rule">
      <h2>Diagnostics</h2>
      <details class="collapse-panel">
        <summary>Diagnostics</summary>
        <p class="tiny muted">Use only when troubleshooting. Hidden by default to keep the guided flow simple.</p>
        <input id="advancedSearch" type="search" placeholder="Search diagnostics buttons" />
        <div class="row">
          <button data-probe="Bridge" id="btnGetUser">getUserInfo()</button>
          <button data-probe="Bridge" id="btnGetDevice">getDeviceInfo()</button>
          <button data-probe="Page" id="btnCreateStartup">createStartUpPageContainer()</button>
          <button data-probe="Page" id="btnTextUpgrade">textContainerUpgrade()</button>
          <button data-probe="Page" id="btnRebuild">rebuildPageContainer()</button>
          <button data-probe="Page" id="btnShutdown">shutDownPageContainer()</button>
          <button data-probe="Storage" id="btnSetLS">setLocalStorage()</button>
          <button data-probe="Storage" id="btnGetLS">getLocalStorage()</button>
          <button data-probe="Audio" id="btnStartMic">audioControl(true)</button>
          <button data-probe="Audio" id="btnStopMic">audioControl(false)</button>
        </div>
      </details>

      <details class="collapse-panel">
        <summary>Capabilities matrix</summary>
        <pre id="matrix">(nothing yet)</pre>
      </details>

      <details class="collapse-panel">
        <summary>Log</summary>
        <pre id="log"></pre>
      </details>
    </section>
  </main>

  <script src="./vendor/qrcode.min.js"></script>
  <script type="module" src="./app.js"></script>
</body>
</html>
